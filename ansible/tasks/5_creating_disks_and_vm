---
- name: creating disks and vms
  hosts: all
  vars_files:
    - templates/cluster_info_variables.yaml
  tasks:
    - name: creating all disks
      loop: "{{cluster_info_variables}}"
      block:
        - name: create disks for non worker nodes
          shell: "virsh vol-create-as default {{item.name}}.qcow2 {{item.disk_size}}"
          when: item.type!='worker'
        - name: create disks for  worker nodes
          shell: "virsh vol-create-as default {{item.name}}.qcow2 {{item.disk_size}} && virsh vol-create-as default {{item.name}}c.qcow2 {{item.disk_size_c}}"
          when: item.type=='worker'
